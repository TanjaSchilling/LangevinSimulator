<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TensorUtils: TensorUtils Version 0.1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TensorUtils
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">TensorUtils Version 0.1 </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#intro">Introduction</a></li>
<li class="level1"><a href="#compile">Compile</a></li>
<li class="level1"><a href="#install">Installation (UBUNTU)</a></li>
<li class="level1"><a href="#no_install">Usage without installation / Installation with user-defined paths</a></li>
<li class="level1"><a href="#examples">Examples</a></li>
<li class="level1"><a href="#error_handling">Error Handling</a></li>
<li class="level1"><a href="#license">License</a></li>
</ul>
</div>
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>22.02.2022 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Christoph Widder </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU Public License.</dd></dl>
<p>TensorUtils is free software. See <a class="el" href="index.html#license">License</a> for the terms of use. You are welcome to report any bugs to <a href="#" onclick="location.href='mai'+'lto:'+'ten'+'so'+'rut'+'il'+'s@g'+'ma'+'il.'+'co'+'m'; return false;">tenso<span class="obfuscator">.nosp@m.</span>ruti<span class="obfuscator">.nosp@m.</span>ls@gm<span class="obfuscator">.nosp@m.</span>ail.<span class="obfuscator">.nosp@m.</span>com</a>. Please visit <a href="https://github.com/TensorUtils/TensorUtils">https://github.com/TensorUtils/TensorUtils</a> for the latest version.</p>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p >TensorUtils presents a tensor class which is derived from std::vector&lt;T&gt;. It allows the usage of all std::vector routines, but has its own constructors. The tensor class allows to allocate, initialize, read and write tensors of floating or integral types up to rank 8. It provides text and binary file formats as well as element-wise operations with support for type conversions and chaining. The usage of this library might help to avoid memory leaks, segmentation faults, nested loops as well as error-prone index conversions. All methods are explicitly instantiated and stored in a shared library, which minimizes the compile time of your source code. Additionally, you will find routines to transpose, reshape and slice tensors as well as a generalized tensor product.</p>
<p >Supported floating point types are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Data Type   </th><th class="markdownTableHeadLeft">Extension    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">float   </td><td class="markdownTableBodyLeft">.f32    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">double   </td><td class="markdownTableBodyLeft">.f64    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">long double   </td><td class="markdownTableBodyLeft">.f80   </td></tr>
</table>
<p >Supported integral types are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Data Type   </th><th class="markdownTableHeadLeft">Extension   </th><th class="markdownTableHeadLeft">Data Type   </th><th class="markdownTableHeadLeft">Extension    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">signed char   </td><td class="markdownTableBodyLeft">.sc   </td><td class="markdownTableBodyLeft">unsigned char   </td><td class="markdownTableBodyLeft">.uc    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">short   </td><td class="markdownTableBodyLeft">.s   </td><td class="markdownTableBodyLeft">unsigned short   </td><td class="markdownTableBodyLeft">.us    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">int   </td><td class="markdownTableBodyLeft">.int   </td><td class="markdownTableBodyLeft">unsigned   </td><td class="markdownTableBodyLeft">.u    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">long   </td><td class="markdownTableBodyLeft">.l   </td><td class="markdownTableBodyLeft">unsigned long   </td><td class="markdownTableBodyLeft">.ul    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">long long   </td><td class="markdownTableBodyLeft">.ll   </td><td class="markdownTableBodyLeft">unsigned long long   </td><td class="markdownTableBodyLeft">.ull   </td></tr>
</table>
<p >The whole project is wrapped into the namespace <a class="el" href="group__TensorUtils.html">TensorUtils</a> from "TensorUtils.hpp". See the main class <a class="el" href="classTensorUtils_1_1TensorBase.html">TensorUtils::TensorBase&lt;T&gt;</a> for routines and examples. Although this base class is fully functional, it is recommended to use the derived class <a class="el" href="classTensorUtils_1_1TensorDerived.html">TensorUtils::TensorDerived&lt;T,N&gt;</a> which allows you to use tensors of arbitrary rank as well as tensors with fixed rank. This will be helpful if you need distinct types for tensors of different ranks. More details on error-handling can be found in <a class="el" href="group__ErrorHandler.html">ErrorHandler</a>.</p>
<p >Once the library is installed, you can use the following alias declarations for the class <a class="el" href="classTensorUtils_1_1TensorDerived.html">TensorUtils::TensorDerived&lt;T,N&gt;</a>. </p><pre class="fragment">#include "TensorUtils.hpp"
int main()
{
    using namespace TensorUtils;
    tensor&lt;double&gt; foo;   // arbitrary rank:  TensorDerived&lt;double,-1&gt;
    tensor&lt;double,4&gt; bar; // fixed rank:      TensorDerived&lt;double,4&gt;
    return 0;
}
</pre> <h1><a class="anchor" id="compile"></a>
Compile</h1>
<p >From within the project folder, type: </p><pre class="fragment">make
</pre><p> This will create a shared library at: </p><pre class="fragment">PATH_TO_TENSOR_UTILS/lib/Release/libtensor_utils.so
PATH_TO_TENSOR_UTILS/lib/Debug/libtensor_utilsd.so
</pre> <h1><a class="anchor" id="install"></a>
Installation (UBUNTU)</h1>
<p >If you don't want to install the library or if you don't want to use the default location, see <a class="el" href="index.html#no_install">Usage without installation / Installation with user-defined paths</a>.</p>
<p >To install the library at the default locations "/usr/local/lib" and "/usr/local/include", type: </p><pre class="fragment">sudo make install
make clean
</pre><p> The header files are now installed as read only (444) in: </p><pre class="fragment">/usr/local/lib/tensor_utils
</pre><p> The shaed library is installed with read and execute permissions (555) at: </p><pre class="fragment">/usr/local/lib/libtensor_utils.so   # use this library for your release
/usr/local/lib/libtensor_utilsd.so  # use this library for debugging
</pre><p> To deinstall the library type: </p><pre class="fragment">sudo make uninstall
</pre><p> Include the header files: </p><pre class="fragment">-I/usr/local/include/tensor_utils
</pre><p> Link the shared library: </p><pre class="fragment">-L/usr/local/lib/
-ltensor_utils
-ltensor_utilsd
</pre><p> Your compile commands could look something like: </p><pre class="fragment"># debug
g++ -Wall -std=c++17 -fexceptions -g -I/usr/local/include/tensor_utils -c main.cpp -o obj/Debug/main.o
g++ -L/usr/local/lib -o bin/Debug/main obj/Debug/main.o   -ltensor_utilsd

# release
g++ -Wall -std=c++17 -fexceptions -O3 -I/usr/local/include/tensor_utils -c main.cpp -o obj/Release/main.o
g++ -L/usr/local/lib -o bin/Release/main obj/Release/main.o   -ltensor_utils
</pre><p> You are ready to run your executable!</p>
<h1><a class="anchor" id="no_install"></a>
Usage without installation / Installation with user-defined paths</h1>
<p >Include the header files: </p><pre class="fragment">-I/PATH_TO_TENSOR_UTILS/include
</pre><p> Link the shared library: </p><pre class="fragment">-L/PATH_TO_TENSOR_UTILS/lib/Release
-L/PATH_TO_TENSOR_UTILS/lib/Debug
-ltensor_utils
-ltensor_utilsd
</pre><p> Your compile commands could look something like: </p><pre class="fragment"># debug
g++ -Wall -std=c++17 -fexceptions -g -I/PATH_TO_TENSOR_UTILS/include -c main.cpp -o obj/Debug/main.o
g++ -L/PATH_TO_TENSOR_UTILS/lib/Debug -o bin/Debug/main obj/Debug/main.o   -ltensor_utilsd

# release
g++ -Wall -std=c++17 -fexceptions -O3 -I/usr/local/include/tensor_utils -c main.cpp -o obj/Release/main.o
g++ -L/PATH_TO_TENSOR_UTILS/lib/Release -o bin/Release/main obj/Release/main.o   -ltensor_utils
</pre><p> To run your executable, you need to make sure that your operating system will find the shared library.</p>
<p >On UBUNTU: </p><pre class="fragment"># Release
cd PATH_TO_TENSOR_UTILS/lib/Release
export LD_LIBRARY_PATH="$(pwd)"

# Debug
cd PATH_TO_TENSOR_UTILS/lib/Debug
export LD_LIBRARY_PATH="$(pwd)"
</pre><p> You are ready to run your executable!</p>
<p >In order to install the library path permanently, create a .conf file in </p><pre class="fragment">/etc/ld.so.conf.d/your_config.conf
</pre><p> add the following paths in this file </p><pre class="fragment">PATH_TO_TENSOR_UTILS/lib/Release
PATH_TO_TENSOR_UTILS/lib/Debug
</pre><p> and update the cache: </p><pre class="fragment">sudo ldconfig
</pre> <h1><a class="anchor" id="examples"></a>
Examples</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;TensorUtils.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>TensorUtils;</div>
<div class="line"><span class="keyword">using namespace </span>ErrorHandler;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> write_test_data()</div>
<div class="line">{</div>
<div class="line">    tensor&lt;long double&gt; A;</div>
<div class="line">    A.alloc({2,3,5,7});</div>
<div class="line">    A.arange();</div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.txt&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.f32&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.f64&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.f80&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.uc&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.sc&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.us&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.s&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.u&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.int&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.ul&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.l&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.ull&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">        A.write(<span class="stringliteral">&quot;A.ll&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">catch</span>(exception &amp;ex){cout&lt;&lt;ex.what()&lt;&lt;endl;}</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    write_test_data();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// CONSTRUCT, ALLOCATE AND INITIALIZE</span></div>
<div class="line"> </div>
<div class="line">    tensor&lt;long double&gt; A;</div>
<div class="line">    tensor&lt;double&gt; B({2,3,5,7});</div>
<div class="line">    tensor&lt;float&gt; C(B.shape, 1.0f);</div>
<div class="line"> </div>
<div class="line">    A.alloc(B.shape);</div>
<div class="line">    A.alloc(B.shape, 2.0L);</div>
<div class="line"> </div>
<div class="line">    B.init(3.0);</div>
<div class="line"> </div>
<div class="line">    A=B=C;      <span class="comment">// OK! Short for: B=C; A=B;</span></div>
<div class="line"> </div>
<div class="line">    A = vector&lt;long double&gt;(A.size(), 1.0L); <span class="comment">// initialize from a vector</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>( A == vector&lt;long double&gt;(A.size(), 1.0L)) <span class="comment">// bit-wise comparison</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    A.arange(); <span class="comment">// initialize with 0,1,2,3,... in lexicographical order.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">long</span> <span class="keywordtype">double</span> raw_data[A.size()];</div>
<div class="line">    A &gt;&gt; raw_data[0]; <span class="comment">// copy data to array</span></div>
<div class="line">    A &lt;&lt; raw_data[0]; <span class="comment">// initialize from array</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">long</span> <span class="keywordtype">double</span> multi_array[2][3][5][7];</div>
<div class="line">    A &gt;&gt; multi_array[0][0][0][0]; <span class="comment">// copy data to multi-dimensional array</span></div>
<div class="line">    A &lt;&lt; multi_array[0][0][0][0]; <span class="comment">// initialize from multi-dimensional array</span></div>
<div class="line"> </div>
<div class="line">    A.print();</div>
<div class="line">    <span class="keywordflow">if</span>(!A.empty())</div>
<div class="line">    {</div>
<div class="line">        A.clear();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  READ AND WRITE</span></div>
<div class="line"> </div>
<div class="line">    A.read(<span class="stringliteral">&quot;A.txt&quot;</span>);    <span class="comment">// text file</span></div>
<div class="line">    A.read(<span class="stringliteral">&quot;./A.f32&quot;</span>);  <span class="comment">// binary: float</span></div>
<div class="line">    A.read(<span class="stringliteral">&quot;./A.f64&quot;</span>);  <span class="comment">// binary: double</span></div>
<div class="line">    A.read(<span class="stringliteral">&quot;./A.f80&quot;</span>);  <span class="comment">// binary: long double</span></div>
<div class="line"> </div>
<div class="line">    A.write(<span class="stringliteral">&quot;A.txt&quot;</span>, <span class="stringliteral">&quot;./&quot;</span>);     <span class="comment">// text file. If floating point type: write std::numeric_limits&lt;T&gt; significant digits</span></div>
<div class="line">    A.write(<span class="stringliteral">&quot;A.txt&quot;</span>, <span class="stringliteral">&quot;./&quot;</span>, 10); <span class="comment">// text file. If floating point type: write 10 significant digits</span></div>
<div class="line">    A.write(<span class="stringliteral">&quot;A.f32&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);      <span class="comment">// binary: float</span></div>
<div class="line">    A.write(<span class="stringliteral">&quot;A.f64&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);      <span class="comment">// binary: double</span></div>
<div class="line">    A.write(<span class="stringliteral">&quot;A.f80&quot;</span>, <span class="stringliteral">&quot;.&quot;</span>);      <span class="comment">// binary: long double</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  OPERATORS</span></div>
<div class="line"> </div>
<div class="line">    B += B;</div>
<div class="line">    B -= B;</div>
<div class="line">    B = B+B;</div>
<div class="line">    B = B-B;</div>
<div class="line">    B *= 2.0;</div>
<div class="line">    B /= 2.0;     <span class="comment">// use *= instead for best performance!</span></div>
<div class="line">    B = 2.0*B;</div>
<div class="line">    B = B*2.0;</div>
<div class="line">    B = B/2.0;    <span class="comment">// use * instead for best performance!</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(A.shape == B.shape &amp;&amp; B.shape == C.shape)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Operators will use implicit type conversion of components if necessary:</span></div>
<div class="line">        A += B;</div>
<div class="line">        A -= B;</div>
<div class="line">        A = B-C;</div>
<div class="line">        A = B+C;</div>
<div class="line">        A = 2*A + 2*( (1.0/3)*B - C );</div>
<div class="line">        C = (-2.0/3)*( 3*C - B ) + 2*A; <span class="comment">// same but faster (operators return tensors of the smaller type)</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> ShapeMismatch(<span class="stringliteral">&quot;Shape mismatch!&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ACCESS ELEMENTS</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> elem = 0;</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n0=0; n0&lt;A.shape[0]; n0++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n1=0; n1&lt;A.shape[1]; n1++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n2=0; n2&lt;A.shape[2]; n2++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> n3=0; n3&lt;A.shape[3]; n3++)</div>
<div class="line">                {</div>
<div class="line">                    A(n0,n1,n2,n3) = elem;</div>
<div class="line">                    elem++;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    elem=0;</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it=A.begin(); it!=A.end(); it++)</div>
<div class="line">    {</div>
<div class="line">        *it = elem;</div>
<div class="line">        elem++;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// SUBTENSORS</span></div>
<div class="line"> </div>
<div class="line">    tensor&lt;int&gt; G({6,2,3,5,7});</div>
<div class="line">    A.alloc({2,3,5,7}, 1.0);</div>
<div class="line">    G.arange();</div>
<div class="line"> </div>
<div class="line">    A.assign(G,{0},{1,1});</div>
<div class="line">    A.add(G, {}, {4});</div>
<div class="line">    A.substract(G, {}, {4});</div>
<div class="line">    A.multiply(2.0, {});</div>
<div class="line">    A.divide(0.5, {});</div>
<div class="line">    A = A.plus(G,{},{1});</div>
<div class="line">    A = A.minus(G,{},{1});</div>
<div class="line">    A = A.product(2.0,{0,0});</div>
<div class="line">    A = G.slice({1,1});</div>
<div class="line">    A = A.quotient(2.0,{1,2});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  TRANSPOSE AND RESHAPE</span></div>
<div class="line"> </div>
<div class="line">    tensor&lt;float&gt; H({2,3,5,7},0);</div>
<div class="line">    H.arange();</div>
<div class="line">    H = H.transpose({3,1,2,0});</div>
<div class="line">    H.reshape({7*3,5*2});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  GENERALIZED TENSOR PRODUCT</span></div>
<div class="line"> </div>
<div class="line">    tensor&lt;double&gt; X({2,3,5,7},1);</div>
<div class="line">    tensor&lt;double&gt; Y({2,3,5,7},2);</div>
<div class="line">    tensor&lt;double&gt; Z;</div>
<div class="line"> </div>
<div class="line">    Z = X.dot(Y,{-1,-2,-3,-4},{-1,-2,-3,-4});   <span class="comment">// full contraction: Z is a scalar!</span></div>
<div class="line"> </div>
<div class="line">    Z = X.dot(Y,{1,2,3,4},{1,2,3,4});       <span class="comment">// Hadamard product: Z has shape {2,3,5,7}</span></div>
<div class="line"> </div>
<div class="line">    Z = X.dot(Y,{1,2,3,4},{8,7,6,5});       <span class="comment">// tensor product: Z has shape {2,3,5,7,7,5,3,2}</span></div>
<div class="line"> </div>
<div class="line">    Z = X.dot(Y,{1,2,3,4},{5,6,7,8},{1,2,4,6}); <span class="comment">// compute sub-tensor of tensor-product</span></div>
<div class="line"> </div>
<div class="line">    X.alloc({2,3,7,7},1);</div>
<div class="line">    Y.alloc({7,5,3,11},2);</div>
<div class="line"> </div>
<div class="line">    Z = X.dot(Y,{3,2,-5,-5},{-5,4,2,1});   <span class="comment">// generalized tensor product: Z has shape {11,3,2,5}</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  TENSORS WITH FIXED RANK AND DISTINGUISHABLE TYPES:</span></div>
<div class="line">    <span class="comment">//      In many situations you might want to keep the types of tensors with different rank distinguishable,</span></div>
<div class="line">    <span class="comment">//      i.e. to overload functions that depend on the rank of its arguments.</span></div>
<div class="line">    <span class="comment">//      Everything works exactly the same, but tensors have fixed ranks!</span></div>
<div class="line"> </div>
<div class="line">    tensor&lt;double&gt; E({2,3,5},1);</div>
<div class="line">    tensor&lt;float,4&gt; F({2,3,5,7},0); <span class="comment">// tensor with fixed rank 4</span></div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        F = E;              <span class="comment">// throws</span></div>
<div class="line">        F.alloc({2,3,5});   <span class="comment">// throws</span></div>
<div class="line">        F.alloc({2,3,5},0);  <span class="comment">// throws</span></div>
<div class="line">        tensor&lt;long double,4&gt; G({2,3,5});   <span class="comment">// throws</span></div>
<div class="line">        tensor&lt;long double,4&gt; H({2,3,5},0); <span class="comment">// throws</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(RankMismatch &amp;ex)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">    }</div>
<div class="line">    E = F; <span class="comment">// OK!</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  ERROR HANDLING (see TensorUtils::ErrorHandling for more)</span></div>
<div class="line">    <span class="comment">//      Most error handling is enabled only for the debug-library libtensor_utilsd.so</span></div>
<div class="line">    <span class="comment">//      This will enable you to trace down any occurrence of invalid indices or shape mismatches.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        A(1,2,3,5);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(ShapeMismatch &amp;ex)<span class="comment">// wrong number of indices</span></div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(out_of_range &amp;ex) <span class="comment">// at least one index is out of range</span></div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        A.read(<span class="stringliteral">&quot;./A.txt&quot;</span>);</div>
<div class="line">        A.read(<span class="stringliteral">&quot;./A.f32&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(UnableToOpenFile &amp; ex) <span class="comment">// probably the required file does not exist</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> ex;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(ShapeMismatch &amp; ex)   <span class="comment">// shape does not match data: corrupted file?</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> ex;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(exception &amp; ex) <span class="comment">// catch any other exception</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> ex;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="error_handling"></a>
Error Handling</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;TensorUtils.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>TensorUtils;</div>
<div class="line"><span class="keyword">using namespace </span>ErrorHandler;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    tensor&lt;double&gt; A;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// READING FILES</span></div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        A.read(<span class="stringliteral">&quot;my_tensor.txt&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(UnableToOpenFile &amp;ex) <span class="comment">// unable to open file</span></div>
<div class="line">    {</div>
<div class="line">        cerr &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(ShapeMismatch &amp; ex)   <span class="comment">// shape does not match data: corrupted file?</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> ex;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(exception &amp; ex) <span class="comment">// catch any other exception</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> ex;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ACCESSING COMPONENTS</span></div>
<div class="line">    A.alloc({2,3,5,7},1.0);</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        A(1,2);         <span class="comment">// OK! Returns A(1,2,0,0) by reference!</span></div>
<div class="line">        A(0,0,0,0,0);   <span class="comment">// too many indices: throws ShapeMismatch</span></div>
<div class="line">        A(1,2,4,7);     <span class="comment">// index out of range: throws std::out_of_range</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(ShapeMismatch &amp;ex) <span class="comment">// more indices than expected!</span></div>
<div class="line">    {</div>
<div class="line">        cerr &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(out_of_range &amp;ex) <span class="comment">// at least one index is out of range</span></div>
<div class="line">    {</div>
<div class="line">        cerr &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// OPERATORS AND MEMBER FUNCTIONS</span></div>
<div class="line">    tensor&lt;double&gt;          B({2,3,5,8},1.0);</div>
<div class="line">    tensor&lt;float&gt;           C({2*3,5*7},1.0);</div>
<div class="line">    tensor&lt;long double&gt;     D({},1.0); <span class="comment">// scalar</span></div>
<div class="line">    tensor&lt;int,3&gt;           E({3,5,7},1.0);</div>
<div class="line">    tensor&lt;unsigned long&gt;   F({3,5,7},1.0);</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        A += B; <span class="comment">// different number of components: throws ShapeMismatch.</span></div>
<div class="line">        A += C; <span class="comment">// OK! Same number of elements, but different shapes!</span></div>
<div class="line">        E = A;  <span class="comment">// RankMismatch: unable to assign with a tensor of different rank!</span></div>
<div class="line">        E = F;  <span class="comment">// OK! Different types, but the ranks are the same.</span></div>
<div class="line">        A = E;  <span class="comment">// OK! A can have arbitrary rank.</span></div>
<div class="line"> </div>
<div class="line">        E.alloc({2,3,5,7}); <span class="comment">// RankMismatch: E has a fixed rank!</span></div>
<div class="line"> </div>
<div class="line">        A.alloc({2,3,5,7},1.0);</div>
<div class="line">        A.assign(B, {1,2}, {1,2});  <span class="comment">// ShapeMismatch: assignment with sub-tensor of invalid shape.</span></div>
<div class="line">        A.assign(C, {1,2}, {0});    <span class="comment">// OK! Same number of elements.</span></div>
<div class="line">        A.assign(C, {1,3}, {0});    <span class="comment">// invalid index: throws std::out_of_range.</span></div>
<div class="line"> </div>
<div class="line">        F = F.transpose({0,2,1}); <span class="comment">// OK! Swap last two axes.</span></div>
<div class="line">        F = F.transpose({1,3,2}); <span class="comment">// ShapeMismatch: Reshape must be a permutation of (0,1,...,N-1).</span></div>
<div class="line"> </div>
<div class="line">        C = A.dot(A, {1,2,3}, {1,2,3,4});   <span class="comment">// ShapeMismatch: axes must have the same size as the shapes.</span></div>
<div class="line"> </div>
<div class="line">        C = A.dot(A, {1,2,3,4}, {5,6,7,8}, {0,0,0,7});  <span class="comment">// invalid index: std::out_of_range.</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(ShapeMismatch &amp;ex)</div>
<div class="line">    {</div>
<div class="line">        cerr &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(RankMismatch &amp;ex)</div>
<div class="line">    {</div>
<div class="line">        cerr &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(out_of_range &amp;ex)</div>
<div class="line">    {</div>
<div class="line">        cerr &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="license"></a>
License</h1>
<pre class="fragment">TensorUtils Version 0.1

Copyright 2022 Christoph Widder

This file is part of TensorUtils.

TensorUtils is free software: you can redistribute it and/or modify it under the terms of
the GNU General Public License as published by the Free Software Foundation, either
version 3 of the License, or (at your option) any later version.

TensorUtils is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with TensorUtils.
If not, see &lt;https://www.gnu.org/licenses/&gt;.
</pre> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
